<head>
<style>
  body {
    font-size: 26pt;
  }
</style>
</head>
<body>
  <script src="https://web-packing.com/@cycle/run&@cycle/dom&xstream"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/loglevel/1.4.1/loglevel.min.js"></script>
  <h3>Counter example</h3>
  <div id="app"></div>
  <script>
  const xs = packs.xstream.default
  const {run} = packs.run
  const {div, button, p, makeDOMDriver} = packs.dom

  const devToolsProducer = {
    start: listener => {
      window.cyclePlug = listener.next.bind(listener)
    },
    stop: () => {
      delete window.cyclePlug
    }
  }

  function main(sources) {
    const devTools$ = xs.create(devToolsProducer)
    const action$ = xs.merge(
      sources.DOM.select('.dec').events('click').mapTo(-1),
      sources.DOM.select('.inc').events('click').mapTo(+1),
      devTools$
    ).debug(log.debug);

    const count$ = action$.fold((x, y) => x + y, 0);

    const vdom$ = count$.map(count =>
      div([
        button('.dec', 'Decrement'),
        button('.inc', 'Increment'),
        p('Counter: ' + count)
      ])
    );

    return {
      DOM: vdom$
    };
  }

  run(main, { DOM: makeDOMDriver('#app') })
  </script>
</body>
